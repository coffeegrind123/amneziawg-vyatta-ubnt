FROM debian:bullseye-slim

RUN apt-get update && \
	apt-get install -y \
	autoconf \
	automake \
	bc \
	bison \
	build-essential \
	curl \
	dpkg-dev \
	fakeroot \
	file \
	flex \
	gawk \
	git \
	libgmp-dev \
	libmpc-dev \
	libmpfr-dev \
	libtool \
	texinfo \
	cpio \
	wget \
	jq \
	libfdt-dev \
	device-tree-compiler && \
	rm -rf /var/lib/apt/lists/*

ENV PATH="/opt/cross/bin:${PATH}"

COPY ci/octeon-toolchain.sh /build_toolchain.sh
COPY apply_libfdt_fix.sh /apply_libfdt_fix.sh

RUN chmod +x /build_toolchain.sh && /build_toolchain.sh && \
    chmod +x /apply_libfdt_fix.sh

ENV CROSSCOMPILE="mips64-octeon-linux-"
